!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("AniJS requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=function(){function b(){this._listeners={}}var c=this,d="data-anijs",e="default",f="$",g="if",h="on",i="do",j="to";c._initializer=function(){c.helperCollection={},c.eventProviderCollection={},c.eventCollection={},c.eventIdCounter=0;var a=c._createDefaultHelper();c.registerHelper(e,a),c.helperDefaultIndex=e,c.rootDOMTravelScope=document,c.Parser=c._createParser(),c.animationEndEvent=c._animationEndPrefix(),c.classNamesWhenAnim=""},c.setDOMRootTravelScope=function(a){var b;try{"document"===a?b=document:(b=document.querySelector(a),b||(b=document))}catch(d){b=document}c.rootDOMTravelScope=b},c.run=function(){var a=[],b={};c.purgeAll(),a=c._findAniJSNodeCollection(c.rootDOMTravelScope);var e,f=a.length,g=0;for(g;f>g;g++)e=a[g],b=c._getParsedAniJSSentenceCollection(e.getAttribute(d)),c._setupElementAnim(e,b)},c.createAnimation=function(a,b){var d=b||"";c._setupElementAnim(d,a)},c.getHelper=function(a){var b=c.helperCollection;return b[a]||b[e]},c.registerHelper=function(a,b){c.helperCollection[a]=b},c.purge=function(a){if(a&&""!==a&&" "!==a){var b=document.querySelectorAll(a),d=b.length,e=0;for(e;d>e;e++)c.purgeEventTarget(b[e])}},c.purgeAll=function(){var a,b,d=c.eventCollection,e=Object.keys(d),f=e.length,g=0;for(g;f>g;g++)a=e[g],b=d[a],b&&b.handleCollection&&b.handleCollection.length>0&&c.purgeEventTarget(b.handleCollection[0].element),delete d[a]},c.purgeEventTarget=function(a){var b,d=a._aniJSEventID;if(d){b=c.eventCollection[d].handleCollection;var e,f=b.length,g=0;for(g;f>g;g++)e=b[g],a.removeEventListener(e.eventType,e.listener);c.eventCollection[d]=null,delete c.eventCollection[d],a._aniJSEventID=null,delete a._aniJSEventID}},c.setClassNamesWhenAnim=function(a){c.classNamesWhenAnim=" "+a},c.createEventProvider=function(){return new b},c.registerEventProvider=function(a){var d=c.eventProviderCollection;return a.id&&a.value&&a.value instanceof b?(d[a.id]=a.value,1):""},c.getEventProvider=function(a){return c.eventProviderCollection[a]},c._createDefaultHelper=function(){var a={removeAnim:function(a,b){b.nodeHelper.removeClass(a.target,b.behavior)}};return a},c._createParser=function(){return new l},c._setupElementAnim=function(a,b){var d,e=b.length,f=0;for(f;e>f;f++)d=b[f],c._setupElementSentenceAnim(a,d)},c._setupElementSentenceAnim=function(a,b){var d=c._eventHelper(b),e=c._eventTargetHelper(a,b);if(""!==d){var f,g=e.length,h=0;for(h;g>h;h++)if(f=e[h],f.addEventListener){var i=function(d){var e=c._behaviorTargetHelper(a,b),f=c._behaviorHelper(b),g=c._beforeHelper(a,b),h=c._afterHelper(a,b);""!==c.classNamesWhenAnim&&(f+=c.classNamesWhenAnim);var i={behaviorTargetList:e,nodeHelper:m,animationEndEvent:c.animationEndEvent,behavior:f,after:h},j=new k(i);g&&c._isFunction(g)?g(d,j):j.run()};f.addEventListener(d,i,!1),c._registerEventHandle(f,d,i)}}},c._registerEventHandle=function(a,b,d){var e=a._aniJSEventID,f=c.eventCollection,g={eventType:b,listener:d,element:a};if(e)f[e].handleCollection.push(g);else{var h={handleCollection:[g]};f[++c.eventIdCounter]=h,a._aniJSEventID=c.eventIdCounter}},c._eventHelper=function(a){var b="",d=a.event||b;return"animationend"===d?d=c._animationEndPrefix():"transitionend"===d&&(d=c._transitionEndPrefix()),d},c._eventTargetHelper=function(b,d){var e,f=b,g=[f],h=c.rootDOMTravelScope;if(d.eventTarget)if(e=c._eventProviderHelper(d.eventTarget),e.length>0)g=e;else if("document"===d.eventTarget)g=[document];else if("window"===d.eventTarget)g=[a];else if(d.eventTarget.split)try{g=h.querySelectorAll(d.eventTarget)}catch(i){g=[]}return g},c._behaviorTargetHelper=function(a,b){var d=a,e=[d],g=c.rootDOMTravelScope,h=b.behaviorTarget;if(h){h=h.split(f).join(",");try{e=g.querySelectorAll(h)}catch(i){e=[]}}return e},c._behaviorHelper=function(a){var b=a.behavior||"";return b},c._afterHelper=function(a,b){var d=c._callbackHelper(a,b,b.after);return d},c._beforeHelper=function(a,b){var d=c._callbackHelper(a,b,b.before);return d},c._callbackHelper=function(a,b,d){var e=d||"",f=c._helperHelper(b);if(e&&!c._isFunction(e)){var g=c.helperCollection,h=g[f];e=h&&h[e]?h[e]:!1}return e},c._helperHelper=function(a){var b=a.helper||c.helperDefaultIndex;return b},c._eventProviderHelper=function(a){{var d=[];c.eventProviderCollection}if(a)if(a.id&&a.value instanceof b)d.push(a.value),c.registerEventProvider(a);else if(a.split){eventProviderIDList=a.split("$");var e,f=eventProviderIDList.length,g=1;for(g;f>g;g++)if(e=eventProviderIDList[g],e&&" "!==e){e=e.trim();var h=c.getEventProvider(e);h||(h=new b,c.registerEventProvider({id:e,value:h})),d.push(h)}}return d},c._getParsedAniJSSentenceCollection=function(a){return c.Parser.parse(a)},c._findAniJSNodeCollection=function(a){var b="["+d+"]";return a.querySelectorAll(b)},c._animationEndPrefix=function(){var a=c._endPrefixBrowserDetectionIndex(),b=["animationend","oAnimationEnd","animationend","webkitAnimationEnd"];return b[a]},c._transitionEndPrefix=function(){var a=c._endPrefixBrowserDetectionIndex(),b=["transitionend","oTransitionEnd","transitionend","webkitTransitionEnd"];return b[a]},c._endPrefixBrowserDetectionIndex=function(){for(var a=document.createElement("fakeelement"),b=["animation","OAnimation","MozAnimation","webkitAnimation"],c=0;c<b.length;c++)if(void 0!==a.style[b[c]])return c},c._isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)};var k=function(a){var b=this;b.initializer=function(a){b.behaviorTargetList=a.behaviorTargetList||[],b.nodeHelper=a.nodeHelper,b.animationEndEvent=a.animationEndEvent,b.behavior=a.behavior,b.after=a.after},b.run=function(){var a,c=b.behaviorTargetList,d=c.length,e=b.nodeHelper,f=b.behavior,g=b.animationEndEvent,h=b.after,i=0;for(i;d>i;i++)a=c[i],e.addClass(a,f),a.addEventListener(g,function(a){a.target.removeEventListener(a.type,arguments.callee),h&&h(a,b)})},b.initializer(a)},l=function(){var a=this;a.parse=function(b){return a._parseDeclaration(b)},a._parseDeclaration=function(b){var c,d,e=[];c=b.split(";");var f=c.length,g=0;for(g;f>g;g++)d=a._parseSentence(c[g]),e.push(d);return e},a._parseSentence=function(b){var c,d,e={};c=b.split(",");var f=c.length,g=0;for(g;f>g;g++)d=a._parseDefinition(c[g]),e[d.key]=d.value;return e},a._parseDefinition=function(a){var b,c,d,e={},f="event",k="eventTarget",l="behavior",m="behaviorTarget";return b=a.split(":"),b.length>1&&(c=b[0].trim(),d=b[1].trim(),c===g?c=f:c===h?c=k:c===i?c=l:c===j&&(c=m),e.key=c,e.value=d),e}},m={addClass:function(a,b){b instanceof Array||(b=b.split(" "));for(var c=0,d=b.length;d>c;++c)b[c]&&!new RegExp("(\\s+|^)"+b[c]+"(\\s+|$)").test(a.className)&&(a.className=a.className.trim()+" "+b[c])},removeClass:function(a,b){b instanceof Array||(b=b.split(" "));for(var c=0,d=b.length;d>c;++c)a.className=a.className.replace(new RegExp("(\\s+|^)"+b[c]+"(\\s+|$)")," ").trim()},toggleClass:function(a,b){b&&(a.className=new RegExp("(\\s+|^)"+b+"(\\s+|$)").test(a.className)?a.className.replace(new RegExp("(\\s+|^)"+b+"(\\s+|$)")," ").trim():a.className.trim()+" "+b)},hasClass:function(a,b){return b&&new RegExp("(\\s+|^)"+b+"(\\s+|$)").test(a.className)}};b.prototype={constructor:b,addEventListener:function(a,b){var c=this;"undefined"==typeof c._listeners[a]&&(c._listeners[a]=[]),c._listeners[a].push(b)},dispatchEvent:function(a){var b=this;if("string"==typeof a&&(a={type:a}),a.target||(a.target=b),!a.type)throw new Error("Event object missing 'type' property.");if(this._listeners[a.type]instanceof Array)for(var c=b._listeners[a.type],d=0,e=c.length;e>d;d++)c[d].call(b,a)},removeEventListener:function(a,b){var c=this;if(c._listeners[a]instanceof Array)for(var d=c._listeners[a],e=0,f=d.length;f>e;e++)if(d[e]===b){d.splice(e,1);break}}},c._initializer()},d=new c;return d.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return d}),"undefined"==typeof b&&(a.AniJS=d),d});